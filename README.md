PCPLogic
--------

This repository contains the code used in the Proof-Carrying Logic paper.

The PCPLogic.agda file describes our proof system and contains all proofs. 

The PCPLogic_no_equality.agda contains all rules except for the equality extension and is used for domains that have no equalities for efficiency.

### Requirements 

This code is tested and compiled with the following:

Agda version 2.6.1

**Libraries**
- Agda Standard Library version 1.4-dev
- Agda Prelude master branch as of 13/04/20

It should be noted that the prelude library is only used in instantiations of 
our system so you can compile PCPLogic.agda without it. The main use of the 
prelude library is to automatically derive equality.

### Examples
All examples used in the paper are contained in the examples folder. 

These folders contain the:

- PDDL problem specification.
- PDDL domain specification.
- Generated Agda file.
- Extracted code binary (if applicable)
- A run.lisp file used for automation.

### Automation

The automation algorithms are run by editing a run.lisp program in the relevant Automation Algorithm folder.

1. Open run.lisp.
2. Change the domainfile and problemfile variables to the path of the pddl domain and problem you want to type check.
3. Set the name of the generated agda file by changing the outputfile variable.
4. Set the plan you want to typecheck to the plan variable.
5. Run the run.lisp file. This will generate and type check an Agda file and proof if the solver finds one. 

The plan syntax is standard lisp list syntax but you need to make sure all arguments are symbols so they need to 
be proceeded with a ' symbol. 

An example blockworld plan: 

(setq plan '((pickup_from_table 'a) (putdown_on_stack 'a 'b)))

### Extraction

To generate an extractable binary file for out implementation do the following: 

1. Add the following code to the end of the file generated by run.lisp:

```haskell
world-eval : World
world-eval = ⟦ plan ⟧ (canonical-σ Γ₁) (σα P [])
```

2. Open extraction.lisp in the extraction folder.
3. Change the domain, problem variables to the pddl domain and problem that you 
want to extract. 
4. Set the name of the generated agda file by changing the outputfile variable.
5. Run extraction.lisp. 
6. Move the extracted file to the folder where all other agda files exist.
7. Compile the generated file with agda --compile filename





